<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ΤΙΤΛΟΣ ΕΡΓΑΣΙΑΣ — Mini Scene</title>

  <!-- A-Frame and extras (keep the versions you used) -->
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>

  <style>
    /* Page layout */
    body { margin: 0; font-family: "Segoe UI", Roboto, Arial, sans-serif; background: #f4f7fb; }

    /* Cover overlay (the "template" - title, name, scenario, credits) */
    #cover {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(10, 20, 30, 0.85);
      color: #fff;
      z-index: 9999;
      padding: 2rem;
    }
    #cover .panel {
      width: min(1000px, 92%);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border-radius: 10px;
      padding: 28px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);
      text-align: center;
    }
    #cover h1 { margin: 0 0 8px; font-size: 2.1rem; letter-spacing: 0.6px; }
    #cover h3 { margin: 0 0 16px; font-weight: 400; opacity: 0.9; }
    #cover .meta { text-align: left; margin: 18px 0; color: #e6eefc; }
    #cover .meta p { margin: 10px 0; line-height: 1.35; }
    #cover .controls { margin-top: 14px; display:flex; gap:12px; justify-content:center; }
    .btn {
      padding: 10px 18px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: 600;
    }
    .btn-start { background: #1e90ff; color: #fff; box-shadow: 0 6px 18px rgba(30,144,255,0.25); }
    .btn-back { background: #2d2d2d; color: #fff; }

    /* Scene container sizing */
    .scene-wrap { display:flex; justify-content:center; padding: 18px 0; }
    a-scene { width: 900px; height: 600px; border: 1px dashed rgba(0,0,0,0.15); }

    /* Small footer area for credits (always visible in page) */
    footer { text-align:center; margin: 12px 0 30px; color:#555; font-size:0.9rem; }
  </style>

  <!-- Your custom component(s) -->
  <script>
    AFRAME.registerComponent('testing', {
      init: function () {
        this.el.addEventListener('click', e => {
          // play the model's animation if present
          if (this.el.components['animation-mixer']) {
            // set the mixer timeScale to 1 so animation will play
            this.el.setAttribute('animation-mixer', { timeScale: 1 });
          }
        });
      }
    });
  </script>
</head>

<body>

  <!-- COVER / TEMPLATE (title, name, scenario, credits) -->
  <div id="cover" role="dialog" aria-labelledby="cover-title" aria-describedby="cover-desc">
    <div class="panel">
      <h1 id="cover-title">ΤΙΤΛΟΣ ΕΡΓΑΣΙΑΣ</h1>
      <h3>Ονοματεπώνυμο — Course / Year</h3>

      <div class="meta" id="cover-desc">
        <p><strong>Σενάριο:</strong></p>
        <p id="scenario">
          Εδώ βάλτε ένα σύντομο περιγραφή του σεναρίου. Π.χ. "Ο πρωταγωνιστής πρέπει να ξεφύγει από το κελί του ενεργοποιώντας μηχανισμούς."
        </p>

        <p><strong>Credits:</strong></p>
        <p id="credits">Ονομα/Ομάδα — Καθηγητής — Τεχνολογίες: A-Frame, fbx-model</p>
      </div>

      <div class="controls">
        <button class="btn btn-start" id="btn-start">Start (Έναρξη)</button>
        <button class="btn btn-back" id="btn-hide">Hide (Απόκρυψη)</button>
      </div>

      <p style="margin-top:12px; color:#cfe6ff; font-size:0.9rem;">
        Press the Start button to enter the scene. You can re-open this cover later with the "Show Cover" button below the scene.
      </p>
    </div>
  </div>

  <!-- Page header matching professor's template -->
  <header style="text-align:center; padding:14px 0;">
    <h2 style="margin:0">Template Integrated Scene</h2>
    <p style="margin:6px 0 0; color:#666;">Αυτή η σελίδα ενσωματώνει το πρότυπο καλύμματος (cover) με την A-Frame σκηνή.</p>
  </header>

  <!-- Scene area -->
  <div class="scene-wrap">
    <a-scene id="scene" cursor="rayOrigin: mouse" background="color: cadetblue" embedded>
      <!-- Example 3D entity (kept your fbx-model attribute) -->
      <a-entity id="prisoner"
                fbx-model="src:url(Dying.fbx)"
                position="0 -1.5 -3"
                scale="0.01 0.01 0.01"
                animation-mixer="loop: once; clampWhenFinished: true; timeScale: 0"
                testing>
      </a-entity>

      <!-- Camera & cursor -->
      <a-entity position="0 1.6 0">
        <a-camera>
          <a-cursor></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>
  </div>

  <!-- Button to re-open the cover after starting -->
  <div style="text-align:center; margin-bottom:10px;">
    <button class="btn btn-back" id="btn-show">Show Cover</button>
  </div>

  <footer>
    <small>Template & Scene — adjust Title / Name / Scenario / Credits inside the cover panel.</small>
  </footer>

  <!-- Clone script and cover control script -->
  <script>
    // Clone the 'prisoner' entity multiple times (you used -300..300 in your example)
    // Adjust positions/scale as needed for your model.
    (function clonePrisoners() {
      const base = document.getElementById('prisoner');
      if (!base) return;
      // Example positions array (you can tune these)
      const positions = [-2, 0, 2]; // left, center, right (meters)
      positions.forEach((x, i) => {
        if (i === 1) return; // skip index 1 because base is already there at 0
        const clone = base.cloneNode(true);
        clone.setAttribute('position', `${x} -1.5 -3`);
        document.getElementById('scene').appendChild(clone);
      });
    })();

    // Cover controls
    const cover = document.getElementById('cover');
    const btnStart = document.getElementById('btn-start');
    const btnHide = document.getElementById('btn-hide');
    const btnShow = document.getElementById('btn-show');

    function startScene() {
      // hide cover
      cover.style.display = 'none';

      // set all animation-mixer components' timeScale to 1 to start animations
      document.querySelectorAll('[animation-mixer]').forEach(el => {
        // set the component attribute (works even if component already initialized)
        el.setAttribute('animation-mixer', Object.assign({}, el.getAttribute('animation-mixer') || {}, { timeScale: 1 }));
        // if component instance exists, update its mixer timeScale too
        if (el.components && el.components['animation-mixer'] && el.components['animation-mixer'].mixer) {
          try {
            el.components['animation-mixer'].mixer.timeScale = 1;
          } catch (err) { /* ignore if not available */ }
        }
      });

      // optional: move camera or perform other setup here
    }

    btnStart.addEventListener('click', startScene);
    // hide without "starting" the animations (keeps them paused) but allow user to continue
    btnHide.addEventListener('click', () => { cover.style.display = 'none'; });
    btnShow.addEventListener('click', () => { cover.style.display = 'flex'; });

    // Accessibility: allow ESC to re-show cover
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') cover.style.display = 'flex';
    });

    // Example: allow cover fields to be edited dynamically (optional)
    // You can change these values programmatically:
    // document.getElementById('cover-title').textContent = 'New Title';
    // document.getElementById('scenario').textContent = 'New scenario text';
    // document.getElementById('credits').textContent = 'New credits';
  </script>

</body>
</html>
